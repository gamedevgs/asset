!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i(require("animejs")):"function"==typeof define&&define.amd?define(["animejs"],i):t.Particles=i(t.anime)}(this,function(t){"use strict";function i(t,i){this.el=function(t){return e.str(t)?document.querySelector(t):t}(t),this.options=o({color:s(this.el,"background-color")},this.defaults,i),this.init()}i.prototype={defaults:{type:"circle",style:"fill",canvasPadding:150,duration:1e3,easing:"easeInOutCubic",direction:"left",size:function(){return Math.floor(3*Math.random()+1)},speed:function(){return h(4)},particlesAmountCoefficient:3,oscillationCoefficient:20},init:function(){this.particles=[],this.frame=null,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.className="particles-canvas",this.canvas.style="display:none;",this.wrapper=document.createElement("div"),this.wrapper.className="particles-wrapper",this.el.parentNode.insertBefore(this.wrapper,this.el),this.wrapper.appendChild(this.el),this.parentWrapper=document.createElement("div"),this.parentWrapper.className="particles",this.wrapper.parentNode.insertBefore(this.parentWrapper,this.wrapper),this.parentWrapper.appendChild(this.wrapper),this.parentWrapper.appendChild(this.canvas)},loop:function(){this.updateParticles(),this.renderParticles(),this.isAnimating()&&(this.frame=requestAnimationFrame(this.loop.bind(this)))},updateParticles:function(){for(var t,i=0;i<this.particles.length;i++)(t=this.particles[i]).life>t.death?this.particles.splice(i,1):(t.x+=t.speed,t.y=this.o.oscillationCoefficient*Math.sin(t.counter*t.increase),t.life++,t.counter+=this.disintegrating?1:-1);this.particles.length||(this.pause(),this.canvas.style.display="none",e.fnc(this.o.complete)&&this.o.complete())},renderParticles:function(){var t;this.ctx.clearRect(0,0,this.width,this.height);for(var i=0;i<this.particles.length;i++)(t=this.particles[i]).life<t.death&&(this.ctx.translate(t.startX,t.startY),this.ctx.rotate(t.angle*Math.PI/180),this.ctx.globalAlpha=this.disintegrating?1-t.life/t.death:t.life/t.death,this.ctx.fillStyle=this.ctx.strokeStyle=t.color,this.ctx.beginPath(),"circle"===this.o.type?this.ctx.arc(t.x,t.y,t.size,0,2*Math.PI):"triangle"===this.o.type?(this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(t.x+t.size,t.y+t.size),this.ctx.lineTo(t.x+t.size,t.y-t.size)):"rectangle"===this.o.type&&this.ctx.rect(t.x,t.y,t.size,t.size),"fill"===this.o.style?this.ctx.fill():"stroke"===this.o.style&&(this.ctx.closePath(),this.ctx.stroke()),this.ctx.globalAlpha=1,this.ctx.rotate(-t.angle*Math.PI/180),this.ctx.translate(-t.startX,-t.startY))},play:function(){this.frame=requestAnimationFrame(this.loop.bind(this))},pause:function(){cancelAnimationFrame(this.frame),this.frame=null},addParticle:function(t){var i=60*this.o.duration/1e3,s=e.fnc(this.o.speed)?this.o.speed():this.o.speed,a=e.fnc(this.o.color)?this.o.color():this.o.color;this.particles.push({startX:t.x,startY:t.y,x:this.disintegrating?0:s*-i,y:0,color:a,angle:h(360),counter:this.disintegrating?0:i,increase:2*Math.PI/100,life:0,death:this.disintegrating?i-20+40*Math.random():i,speed:s,size:e.fnc(this.o.size)?this.o.size():this.o.size})},addParticles:function(t,i){var e=this.disintegrating?i-this.lastProgress:this.lastProgress-i;this.lastProgress=i;var s=this.options.canvasPadding,a=this.options.canvasPadding,n=(this.isHorizontal()?t.width:t.height)*i+e*(this.disintegrating?100:220);this.isHorizontal()?s+="left"===this.o.direction?n:t.width-n:a+="top"===this.o.direction?n:t.height-n;var r=Math.floor(this.o.particlesAmountCoefficient*(100*e+1));if(r>0)for(;r--;)this.addParticle({x:s+(this.isHorizontal()?0:t.width*Math.random()),y:a+(this.isHorizontal()?t.height*Math.random():0)});this.isAnimating()||(this.canvas.style.display="block",this.play())},addTransforms:function(t){var i=this.isHorizontal()?"translateX":"translateY",e="left"===this.o.direction||"top"===this.o.direction?t:-t;this.wrapper.style[n]=i+"("+e+"%)",this.el.style[n]=i+"("+-e+"%)"},disintegrate:function(t){if(!this.isAnimating()){this.disintegrating=!0,this.lastProgress=0,this.setup(t);var i=this;this.animate(function(t){var e=t.animatables[0].target.value;i.addTransforms(e),i.o.duration&&i.addParticles(i.rect,e/100,!0)})}},integrate:function(t){if(!this.isAnimating()){this.disintegrating=!1,this.lastProgress=1,this.setup(t);var i=this;this.animate(function(t){var e=t.animatables[0].target.value;setTimeout(function(){i.addTransforms(e)},i.o.duration),i.o.duration&&i.addParticles(i.rect,e/100,!0)})}},setup:function(t){this.o=o({},this.options,t),this.wrapper.style.visibility="visible",this.o.duration&&(this.rect=this.el.getBoundingClientRect(),this.width=this.canvas.width=this.o.width||this.rect.width+2*this.o.canvasPadding,this.height=this.canvas.height=this.o.height||this.rect.height+2*this.o.canvasPadding)},animate:function(i){var e=this;t({targets:{value:e.disintegrating?0:101},value:e.disintegrating?101:0,duration:e.o.duration,easing:e.o.easing,begin:e.o.begin,update:i,complete:function(){e.disintegrating&&(e.wrapper.style.visibility="hidden")}})},isAnimating:function(){return!!this.frame},isHorizontal:function(){return"left"===this.o.direction||"right"===this.o.direction}};var e={arr:function(t){return Array.isArray(t)},str:function(t){return"string"==typeof t},fnc:function(t){return"function"==typeof t}};function s(t,i){if(i in t.style)return getComputedStyle(t).getPropertyValue(i.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase())||"0"}var a="transform",n=s(document.body,a)?a:"-webkit-"+a;function r(t,i){for(var s in i)t[s]=e.arr(i[s])?i[s].slice(0):i[s];return t}function o(t){t||(t={});for(var i=1;i<arguments.length;i++)r(t,arguments[i]);return t}function h(t){return Math.random()*t-t/2}return i});